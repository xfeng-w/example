package com.xfeng.example;

import java.io.*;
import java.util.*;

/**
 * @author xuefeng.wang
 * @date 2020-10-30
 */
public class ShellDealerImport2 {

    public static void main(String[] args) throws IOException {
        File file = new File("C:\\Users\\TY\\Desktop\\cfDealer.txt");
        FileReader fileReader = new FileReader(file);
        BufferedReader bufferedReader = new BufferedReader(fileReader);
        List<String> list = new ArrayList<>();
        String str;
        while ((str = bufferedReader.readLine()) != null) {
            list.add(str);
        }
        long[][] dealerCodes = {{12090260, 41},
                {12650814, 43},
                {12744232, 44},
                {12643470, 45},
                {12744016, 46},
                {12647681, 47},
                {12686157, 48},
                {12217722, 49},
                {12669035, 51},
                {12677447, 52},
                {12090716, 53},
                {12671174, 54},
                {12090696, 56},
                {12091417, 57},
                {12738891, 58},
                {12543170, 59},
                {12090254, 60},
                {12170170, 61},
                {12757363, 62},
                {12751893, 63},
                {12685623, 64},
                {12740491, 65},
                {12675310, 66},
                {12462556, 69},
                {12665253, 71},
                {12742678, 72},
                {12505934, 73},
                {12089142, 74},
                {12091373, 76},
                {12510660, 78},
                {12711585, 79},
                {12662500, 80},
                {12744180, 81},
                {12644601, 82},
                {12744451, 83},
                {12744193, 84},
                {12670009, 85},
                {12738368, 86},
                {12743084, 87},
                {12670005, 88},
                {12587985, 90},
                {12751666, 91},
                {12711582, 92},
                {12091681, 94},
                {12484534, 95},
                {12710863, 96},
                {12091788, 97},
                {12757331, 98},
                {12468691, 99},
                {12091428, 10},
                {12089587, 10},
                {12669784, 10},
                {12196265, 10},
                {12612551, 10},
                {12752111, 10},
                {12089487, 10},
                {12091438, 11},
                {12673624, 11},
                {12413229, 11},
                {12090788, 11},
                {12089333, 11},
                {12508888, 11},
                {12438422, 11},
                {12652689, 12},
                {12757062, 12},
                {12751894, 12},
                {12090411, 12},
                {12660637, 12},
                {12757864, 12},
                {12755669, 13},
                {12090378, 13},
                {12647553, 13},
                {12622871, 13},
                {12089103, 13},
                {12691017, 13},
                {12666303, 14},
                {12618485, 14},
                {12091906, 14},
                {12647078, 14},
                {12091644, 14},
                {12675306, 14},
                {12756023, 14},
                {12641070, 15},
                {12709261, 15},
                {12666839, 15},
                {12658841, 15},
                {12647489, 15},
                {12468717, 16},
                {12664776, 16},
                {12090583, 16},
                {12508883, 16},
                {12091790, 16},
                {12089671, 17},
                {12739963, 17},
                {12574182, 17},
                {12713191, 17},
                {12675964, 17},
                {12742854, 17},
                {12623269, 17},
                {12526203, 18},
                {12658606, 18},
                {12091632, 18},
                {12622866, 18},
                {12628376, 18},
                {12657645, 18},
                {12636123, 19},
                {12501892, 19},
                {12690780, 19},
                {12090581, 19},
                {12583084, 19},
                {12091464, 20},
                {12743560, 20},
                {12089404, 20},
                {12744447, 20},
                {12089673, 20},
                {12089376, 21},
                {12091405, 21},
                {12689310, 21},
                {12091401, 21},
                {12192529, 21},
                {12620476, 21},
                {12454331, 21},
                {12712227, 21},
                {12691023, 22},
                {12091469, 22},
                {12484732, 22},
                {12652678, 22},
                {12726033, 22},
                {12498618, 23},
                {12474682, 23},
                {12727201, 23},
                {12649500, 23},
                {12567503, 24},
                {12090366, 24},
                {12429509, 24},
                {12089119, 24},
                {12159662, 24},
                {12218073, 24},
                {12091600, 24},
                {12216516, 24},
                {12684208, 25},
                {12665917, 25},
                {12090633, 25},
                {12711891, 25},
                {12457843, 25},
                {12575400, 25},
                {12671149, 25},
                {12682377, 26},
                {12091533, 26},
                {12680259, 26},
                {12657281, 26},
                {12499276, 26},
                {12672366, 26},
                {12090644, 26},
                {12647442, 27},
                {12671280, 27},
                {12665254, 27},
                {12623862, 27},
                {12104605, 27},
                {12584941, 27},
                {12686127, 27},
                {12713688, 28},
                {12175948, 28},
                {12089499, 28},
                {12353665, 28},
                {12508882, 28},
                {12713445, 28},
                {12383645, 29},
                {12657330, 29},
                {12641531, 29},
                {12645929, 29},
                {12637971, 29},
                {12659897, 29},
                {12462504, 29},
                {12502347, 30},
                {12664846, 30},
                {12619157, 30},
                {12089329, 30},
                {12487430, 30},
                {12689279, 30},
                {12682473, 30},
                {12661669, 30},
                {12091374, 30},
                {12711305, 31},
                {12569512, 31},
                {12091416, 31},
                {12660663, 31},
                {12663586, 31},
                {12191056, 31},
                {12646215, 32},
                {12104624, 32},
                {12654632, 32},
                {12651234, 32},
                {12283782, 32},
                {12089645, 32},
                {12631109, 33},
                {12618580, 33},
                {12664328, 33},
                {12673637, 33},
                {12716202, 33},
                {12728985, 34},
                {12090642, 34},
                {12617781, 34},
                {12687310, 34},
                {12091471, 35},
                {12666465, 35},
                {12091636, 35},
                {12687264, 35},
                {12457812, 35},
                {12725812, 36},
                {12711299, 36},
                {12655572, 36},
                {12220688, 36},
                {12468433, 36},
                {12412650, 36},
                {12290261, 37},
                {12181132, 37},
                {12647691, 37},
                {12714835, 37},
                {12103517, 37},
                {12660625, 37},
                {12277739, 37},
                {12448121, 38},
                {12666178, 38},
                {12739423, 38},
                {12231348, 38},
                {12647261, 38},
                {12090394, 38},
                {12089130, 38},
                {12664331, 39},
                {12747377, 39},
                {12647757, 39},
                {12662614, 39},
                {12090652, 39},
                {12259651, 40},
                {12276275, 40},
                {12499064, 40},
                {12356948, 40},
                {12712873, 40},
                {12691506, 40},
                {12661807, 41},
                {12089128, 41},
                {12720871, 41},
                {12631558, 41},
                {12091413, 41},
                {12422859, 41},
                {12088918, 41},
                {12430032, 42},
                {12090847, 42},
                {12091760, 42},
                {12668377, 42},
                {12608088, 43},
                {12108751, 43},
                {12714134, 43},
                {12090477, 43},
                {12531237, 43},
                {12444032, 44},
                {12655434, 44},
                {12457783, 44},
                {12621123, 44},
                {12689145, 44},
                {12422102, 44},
                {12627533, 45},
                {12747833, 45},
                {12088919, 45},
                {12595216, 45},
                {12364311, 45},
                {12428915, 45},
                {12711115, 45},
                {12591252, 46},
                {12089547, 46},
                {12619854, 46},
                {12090438, 46},
                {12599446, 46},
                {12577252, 46},
                {12666836, 46},
                {12682507, 46},
                {12390811, 47},
                {12192940, 47},
                {12574136, 47},
                {12546832, 47},
                {12544969, 47},
                {12649407, 47},
                {12089111, 47},
                {12409552, 47},
                {12090261, 48},
                {12679433, 48},
                {12688389, 48},
                {12614458, 48},
                {12524836, 48},
                {12171323, 48},
                {12588808, 48},
                {12646214, 49},
                {12091578, 49},
                {12609961, 49},
                {12724453, 49},
                {12091431, 50},
                {12360439, 50},
                {12669949, 50},
                {12738323, 50},
                {12747384, 51},
                {12674579, 51},
                {12714831, 51},
                {12597146, 51},
                {12675573, 52},
                {12645908, 52},
                {12743562, 52},
                {12674215, 52},
                {12685434, 52},
                {12090452, 52},
                {12744869, 53},
                {12090544, 53},
                {12179416, 53},
                {12627393, 53},
                {12669909, 53},
                {12675314, 53},
                {12624310, 54},
                {12527683, 54},
                {12733953, 54},
                {12518455, 54},
                {12729183, 54},
                {12677434, 54},
                {12654293, 55},
                {12668877, 55},
                {12669612, 55},
                {12090794, 55},
                {12089393, 55},
                {12540886, 55},
                {12090857, 55},
                {12658199, 56},
                {12090538, 56},
                {12680560, 56},
                {12509245, 56},
                {12662505, 56},
                {12089236, 56},
                {12669619, 57},
                {12710143, 57},
                {12285634, 57},
                {12506173, 57},
                {12709461, 57},
                {12571880, 57},
                {12089179, 58},
                {12090692, 58},
                {12733422, 58},
                {12637970, 58},
                {12579602, 58},
                {12448949, 58},
                {12738897, 58},
                {12647687, 58},
                {12492185, 58},
                {12228369, 59},
                {12729007, 59},
                {12516380, 59},
                {12302561, 59},
                {12688029, 59},
                {12720890, 59},
                {12091440, 60},
                {12619623, 60},
                {12090601, 60},
                {12654612, 60},
                {12722009, 60},
                {12722228, 60},
                {12469316, 60},
                {12412649, 61},
                {12660259, 61},
                {12090475, 61},
                {12089102, 61},
                {12661806, 61},
                {12712595, 62},
                {12714726, 62},
                {12617771, 62},
                {12476039, 62},
                {12691448, 62},
                {12361512, 62},
                {12530896, 63},
                {12652675, 63},
                {12192178, 63},
                {12659677, 63},
                {12356912, 63},
                {12671661, 63},
                {12673610, 64},
                {12491429, 64},
                {12685575, 64},
                {12207849, 64},
                {12574137, 64},
                {12623835, 64},
                {12628506, 65},
                {12591253, 65},
                {12104604, 65},
                {12682505, 65},
                {12226662, 65},
                {12602855, 66},
                {12651394, 66},
                {12350589, 66},
                {12650650, 66},
                {12090463, 67},
                {12659573, 67},
                {12091882, 68},
                {12249328, 68},
                {12622045, 68},
                {12628361, 68},
                {12660026, 68},
                {12691462, 68},
                {12641179, 68},
                {12089457, 69},
                {12624927, 69},
                {12730110, 69},
                {12592943, 69},
                {12586246, 69},
                {12747740, 69},
                {12586483, 69},
                {12503292, 70},
                {12104613, 70},
                {12091757, 70},
                {12091775, 70},
                {12636050, 70},
                {12089311, 70},
                {12091415, 70},
                {12525795, 70},
                {12649408, 70},
                {12619987, 70},
                {12682083, 71},
                {12717676, 71},
                {12091566, 71},
                {12487440, 71},
                {12682448, 71},
                {12538686, 71},
                {12684352, 72},
                {12631557, 72},
                {12646954, 72},
                {12509279, 72},
                {12643633, 72},
                {12760576, 73},
                {12761802, 73},
                {12758509, 73},
                {12766047, 73},
                {12761132, 73},
                {12761464, 74},
                {12761501, 74},
                {12761508, 74},
                {12761620, 74},
                {12762029, 74},
                {12761282, 74},
                {12760570, 74},
                {12761292, 74},
                {12760571, 74},
                {12761999, 74},
                {12761510, 75},
                {12758652, 75},
                {12776608, 78},
                {12774542, 79},
                {12767194, 79},
                {12772076, 79},
                {12773881, 79},
                {12770373, 79},
                {12769668, 79},
                {12770141, 79},
                {12776631, 79},
                {12772770, 79},
                {12771015, 79},
                {12772576, 80},
                {12771377, 80},
                {12778948, 80},
                {12776641, 80},
                {12772839, 80},
                {12776466, 80},
                {12773055, 80},
                {12778218, 80},
                {12767823, 80},
                {12776515, 80},
                {12778951, 81},
                {12780362, 81},
                {12782921, 81},
                {12782987, 81},
                {12587975, 81},
                {12787438, 81},
                {12786882, 81},
                {12788378, 82},
                {12789571, 82},
                {12793976, 82},
                {12792125, 82},
                {12793944, 82},
                {12792123, 82}};
        Map<String, Long> dealerMap = new HashMap<>();
        for (long[] item : dealerCodes) {
            dealerMap.put("" + item[0], item[1]);
        }

        String sql = "insert into dealer (dealer_type, parent_id, name, code, level, ese_id, dept_id, status, created_by, created_time,\n" +
                "                    updated_by, updated_time, version, custom_fields, sales_area_code, province_code, city_code,\n" +
                "                    county_code, address)\n" +
                "select 1, %s, '%s', '%s', 2, 3, 3, 1, 7, NOW(), 7, NOW(), 1, null, null, null, null, null, null\n" +
                "from DUAL\n" +
                "where not exists (select * from dealer where code = '%s' and ese_id = 3);";
        fileReader.close();
        bufferedReader.close();
        int level1 = 0;
        List<String> dealers = new ArrayList<>();
        for (String s : list) {
            String[] dealer = s.split(",");
            if (!dealer[0].equals(dealer[1])) {
                level1++;
                String deaSql = String.format(sql, dealerMap.get(dealer[0]), dealer[2], dealer[1], dealer[1]);
                dealers.add(deaSql);
                if (Objects.isNull(dealerMap.get(dealer[0]))) {
                    System.out.println(dealer[0] + "," + dealer[1] + "," + dealer[2]);
                }
            }
        }
//        writeFile(dealers);
        System.out.println(level1);
    }

    public static void writeFile(List<String> data) {
        try {
            File writeName = new File("C:\\Users\\TY\\Desktop\\cfDealerTwo.sql"); // 相对路径，如果没有则要建立一个新的output.txt文件
            writeName.createNewFile(); // 创建新文件,有同名的文件的话直接覆盖
            try (FileWriter writer = new FileWriter(writeName);
                 BufferedWriter out = new BufferedWriter(writer)
            ) {
                for (String item : data) {
                    out.write(item + "\r\n"); // \r\n即为换行
                }

                out.flush(); // 把缓存区内容压入文件
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
